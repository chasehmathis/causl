<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discrete Variables Copula • causl</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Discrete Variables Copula">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">causl</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.10.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Comparison.html">Comparison of Methods</a>
    </li>
    <li>
      <a href="../articles/CopulaSimulation.html">Copula Simulation</a>
    </li>
    <li>
      <a href="../articles/CustomFamilies.html">Custom Families</a>
    </li>
    <li>
      <a href="../articles/Discrete_Variables_Copula.html">Discrete Variables Copula</a>
    </li>
    <li>
      <a href="../articles/Families.html">Families, link functions and parameters</a>
    </li>
    <li>
      <a href="../articles/Hidden_Variables.html">Hidden Variables</a>
    </li>
    <li>
      <a href="../articles/HTEs.html">Heterogeneous TEs</a>
    </li>
    <li>
      <a href="../articles/Inversion.html">Inversion Tutorial</a>
    </li>
    <li>
      <a href="../articles/Plasmode.html">Plasmode Simulation</a>
    </li>
    <li>
      <a href="../articles/PowerCalculations.html">Inversion Tutorial</a>
    </li>
    <li>
      <a href="../articles/Simple-Copula-Parametrization.html">Specifying Copula Models through Correlation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Discrete Variables Copula</h1>
                        <h4 data-toc-skip class="author">Robin J.
Evans</h4>
            
            <h4 data-toc-skip class="date">2025-08-27</h4>
      

      <div class="hidden name"><code>Discrete_Variables_Copula.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="incorporating-discrete-variables">Incorporating discrete variables<a class="anchor" aria-label="anchor" href="#incorporating-discrete-variables"></a>
</h2>
<p>We can also fit models in which some of the covariates and/or
outcomes are binary. For example, suppose we assume that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><msub><mi>Z</mi><mn>1</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mn>1</mn><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><msub><mi>Z</mi><mn>2</mn></msub></mtd><mtd columnalign="left" style="text-align: left"><mo>∼</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>p</mi><mn>2</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="right" style="text-align: right"><mi>Y</mi><mo>∣</mo><mi>d</mi><mi>o</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>X</mi><mo>=</mo><mi>x</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mi>y</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
Z_1 &amp;\sim N(0, \sigma_1^2) &amp; Z_2 &amp;\sim \text{Bernoulli}(p_2) &amp; Y \mid do(X=x) \sim N(0, \sigma_y^2)
\end{align*}</annotation></semantics></math> and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∣</mo><msub><mi>Z</mi><mn>1</mn></msub><mo>=</mo><msub><mi>z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>=</mo><msub><mi>z</mi><mn>2</mn></msub><mo>∼</mo><mtext mathvariant="normal">Bernoulli</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>q</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">X \mid Z_1=z_1,Z_2=z_2 \sim \text{Bernoulli}(q)</annotation></semantics></math>,
and we assume a Gaussian copula over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><msub><mi>Z</mi><mn>2</mn></msub><mo>,</mo><mi>Y</mi></mrow><annotation encoding="application/x-tex">Z_1,Z_2,Y</annotation></semantics></math>
with correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>R</mi><annotation encoding="application/x-tex">R</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><msub><mi>Z</mi><mn>1</mn></msub><msub><mi>Z</mi><mn>2</mn></msub></mrow></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">\rho_{Z_1Z_2} = 0.5</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><msub><mi>Z</mi><mn>1</mn></msub><mi>Y</mi></mrow></msub><mo>=</mo><mn>0.3</mn></mrow><annotation encoding="application/x-tex">\rho_{Z_1Y} = 0.3</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><msub><mi>Z</mi><mn>2</mn></msub><mi>Y</mi></mrow></msub><mo>=</mo><mn>0.4</mn></mrow><annotation encoding="application/x-tex">\rho_{Z_2Y} = 0.4</annotation></semantics></math>.</p>
<p>Then we can set up this model in the usual way:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Z1</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">Z2</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span>, <span class="va">X</span> <span class="op">~</span> <span class="va">Z1</span><span class="op">*</span><span class="va">Z2</span>, <span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">fams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Z1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fl">0</span>, phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>             Z2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>             X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.25</span>, <span class="fl">0.5</span><span class="op">)</span>, phi<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>             cop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/causl_model.html">causl_model</a></span><span class="op">(</span>formulas <span class="op">=</span> <span class="va">forms</span>, family <span class="op">=</span> <span class="va">fams</span>, pars <span class="op">=</span> <span class="va">pars</span><span class="op">)</span></span></code></pre></div>
<p>Now call <code>rfrugal</code> as usual.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1e4</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfrugal.html">rfrugal</a></span><span class="op">(</span><span class="va">n</span>, causl_model <span class="op">=</span> <span class="va">cm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Inversion method selected: using pair-copula parameterization</span></span></code></pre>
<p>Then we can check that the distributions follow the specification
that we asked for.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/ks.test.html" class="external-link">ks.test</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Z1</span>, <span class="va">pnorm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Asymptotic one-sample Kolmogorov-Smirnov test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  dat$Z1</span></span>
<span><span class="co">## D = 0.01, p-value = 0.2</span></span>
<span><span class="co">## alternative hypothesis: two-sided</span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/binom.test.html" class="external-link">binom.test</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">dat</span><span class="op">$</span><span class="va">Z2</span><span class="op">)</span>, n<span class="op">=</span><span class="va">n</span>, p <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">##  Exact binomial test</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## data:  sum(dat$Z2) and n</span></span>
<span><span class="co">## number of successes = 5099, number of trials = 10000, p-value = 0.05</span></span>
<span><span class="co">## alternative hypothesis: true probability of success is not equal to 0.5</span></span>
<span><span class="co">## 95 percent confidence interval:</span></span>
<span><span class="co">##  0.50 0.52</span></span>
<span><span class="co">## sample estimates:</span></span>
<span><span class="co">## probability of success </span></span>
<span><span class="co">##                   0.51</span></span></code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glmX</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">X</span> <span class="op">~</span> <span class="va">Z1</span><span class="op">*</span><span class="va">Z2</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmX</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
<pre><code><span><span class="co">##             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">## (Intercept)  -0.3056     0.0289 -10.564 4.36e-26</span></span>
<span><span class="co">## Z1            0.0757     0.0293   2.586 9.70e-03</span></span>
<span><span class="co">## Z2            0.1623     0.0403   4.024 5.73e-05</span></span>
<span><span class="co">## Z1:Z2         0.0323     0.0409   0.788 4.31e-01</span></span></code></pre>
<p>These are all consistent with the values we provided. We can finally
check the outcome model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">glmX</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">wt</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">X</span><span class="op">/</span><span class="va">ps</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">dat</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ps</span><span class="op">)</span></span>
<span><span class="va">glmY</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svyglm.html" class="external-link">svyglm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">X</span>, design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span>, weights<span class="op">=</span><span class="va">wt</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmY</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
<pre><code><span><span class="co">##             Estimate Std. Error t value  Pr(&gt;|t|)</span></span>
<span><span class="co">## (Intercept)   -0.244    0.00966   -25.3 1.31e-136</span></span>
<span><span class="co">## X              0.493    0.01430    34.5 2.85e-246</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="categorical-and-ordinal-variables">Categorical and Ordinal Variables<a class="anchor" aria-label="anchor" href="#categorical-and-ordinal-variables"></a>
</h2>
<p>We can also extend this to variables that are categorical or ordered
categorical. These options correspond to the family indicators 11 and 10
respectively, or they can be accessed by passing the strings
<code>"categorical"</code> and <code>"ordinal"</code> to the
<code>family</code> argument. Both types of variable are stored as a
factor, with labels for the objects <code>1</code>, <code>2</code>, up
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>ℓ</mo><annotation encoding="application/x-tex">\ell</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>ℓ</mo><annotation encoding="application/x-tex">\ell</annotation></semantics></math>
is the number of levels.</p>
<p>These methods respectively use a contrast with the baseline level, or
a contrast with the category immediately below the current one in the
ordering. For example, if we have a three variable categorical variable
using the formula <code>Z ~ A</code> then the parameters are of the
form:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mo>log</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><msub><mi>β</mi><mrow><mn>0</mn><mi>i</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mi>a</mi><mi>i</mi></mrow></msub><mi>a</mi><mo>,</mo></mtd><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mi>i</mi><mo>=</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mo>ℓ</mo><mi>.</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\log \frac{P(Z=i)}{P(Z=1)} &amp;= \beta_{0i} + \beta_{ai} a, &amp; &amp; i = 2,\ldots,\ell.
\end{align*}</annotation></semantics></math> For a categorical variable
the contrasts become
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mo stretchy="false" form="prefix">{</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\log \{P(Z=i)/P(Z=i-1)\}</annotation></semantics></math>
for the same range of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>.</p>
<p>The regression parameters can be passed either as a vector or a
matrix, but in either case they must be ordered so that all the
coefficients for one contrast precede all those for another. For
example, if we want we could put
<code>Z = list(beta = c(0.5,0.1,-0.5,0.4), nlevel = 3)</code> in the
<code>pars</code> argument to require that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mo>log</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>0.5</mn><mo>+</mo><mn>0.1</mn><mi>a</mi></mtd><mtd columnalign="right" style="text-align: right"><mo>log</mo><mfrac><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mi>−</mi><mn>0.5</mn><mo>+</mo><mn>0.4</mn><mi>a</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\log \frac{P(Z=2)}{P(Z=1)} &amp;= 0.5 + 0.1 a &amp; \log \frac{P(Z=3)}{P(Z=1)} &amp;= -0.5 + 0.4 a
\end{align*}</annotation></semantics></math> for an unordered
categorical variable, and the same for an ordinal variable but replacing
the second quantity with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mo stretchy="false" form="prefix">{</mo><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mn>3</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mi>P</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>Z</mi><mo>=</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\log \{P(Z=3)/P(Z=2)\}</annotation></semantics></math>.
Equivalently, we could put
<code>Z = list(beta = matrix(c(0.5,0.1,-0.5,0.4), nrow=2), nlevel = 3)</code>,
and the same model would be fitted.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">forms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">Z0</span> <span class="op">~</span> <span class="va">A0</span>, <span class="va">Z1</span> <span class="op">~</span> <span class="va">A0</span><span class="op">)</span>,</span>
<span>              <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">A0</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">A1</span> <span class="op">~</span> <span class="va">A0</span><span class="op">*</span><span class="va">Z0</span><span class="op">)</span>,</span>
<span>              <span class="va">Y</span> <span class="op">~</span> <span class="va">A0</span><span class="op">*</span><span class="va">A1</span>,</span>
<span>              <span class="op">~</span> <span class="va">A0</span><span class="op">)</span></span>
<span><span class="va">fams</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"categorical"</span>,<span class="st">"categorical"</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">5</span><span class="op">)</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>A0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,</span>
<span>             Z0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span><span class="op">)</span>, nlevel<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>             Z1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>,<span class="op">-</span><span class="fl">0.2</span>,<span class="fl">0.4</span>,<span class="fl">0.1</span><span class="op">)</span>, nlevel<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>             A1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="fl">0.3</span>,<span class="fl">0.5</span>,<span class="fl">0.3</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             Y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0</span><span class="op">)</span>, phi<span class="op">=</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>             cop <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/causl_model.html">causl_model</a></span><span class="op">(</span>formulas<span class="op">=</span><span class="va">forms</span>, pars<span class="op">=</span><span class="va">pars</span>, family<span class="op">=</span><span class="va">fams</span><span class="op">)</span></span></code></pre></div>
<p>In this case we set both covariate variables to be categorical.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5e4</span></span>
<span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/rfrugal.html">rfrugal</a></span><span class="op">(</span>n<span class="op">=</span><span class="va">n</span>, causl_model<span class="op">=</span><span class="va">cm</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Inversion method selected: using pair-copula parameterization</span></span></code></pre>
<p>Now we can check that the parameters being simulated match those
input.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Z0</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">~</span> <span class="va">A0</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Z0</span> <span class="op">!=</span> <span class="fl">3</span>,<span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
<pre><code><span><span class="co">## (Intercept)          A0 </span></span>
<span><span class="co">##       0.307      -0.185</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Z0</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="va">A0</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Z0</span> <span class="op">!=</span> <span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
<pre><code><span><span class="co">## (Intercept)          A0 </span></span>
<span><span class="co">##      0.4175      0.0963</span></span></code></pre>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Z1</span><span class="op">==</span><span class="fl">2</span><span class="op">)</span> <span class="op">~</span> <span class="va">A0</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Z1</span> <span class="op">!=</span> <span class="fl">3</span>,<span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span></span></code></pre></div>
<pre><code><span><span class="co">## (Intercept)          A0 </span></span>
<span><span class="co">##       0.306      -0.197</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">Z1</span><span class="op">==</span><span class="fl">3</span><span class="op">)</span> <span class="op">~</span> <span class="va">A0</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">[</span><span class="va">dat</span><span class="op">$</span><span class="va">Z1</span> <span class="op">!=</span> <span class="fl">2</span>,<span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">coefficients</span> </span></code></pre></div>
<pre><code><span><span class="co">## (Intercept)          A0 </span></span>
<span><span class="co">##       0.378       0.132</span></span></code></pre>
<p>Finally, we can check that the outcome model works as it should.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">A1</span> <span class="op">~</span> <span class="va">A0</span><span class="op">*</span><span class="va">Z0</span>, family<span class="op">=</span><span class="va">binomial</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"response"</span><span class="op">)</span></span>
<span><span class="va">wt</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">$</span><span class="va">A1</span><span class="op">/</span><span class="va">ps</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">dat</span><span class="op">$</span><span class="va">A1</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">ps</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svyglm.html" class="external-link">svyglm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">A0</span><span class="op">*</span><span class="va">A1</span>, design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">dat</span>,weights<span class="op">=</span><span class="va">wt</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span></span></code></pre></div>
<pre><code><span><span class="co">##             Estimate Std. Error t value  Pr(&gt;|t|)</span></span>
<span><span class="co">## (Intercept)  -0.5058    0.00906 -55.819  0.00e+00</span></span>
<span><span class="co">## A0            0.2010    0.01786  11.253  2.43e-29</span></span>
<span><span class="co">## A1            0.3053    0.01284  23.770 3.38e-124</span></span>
<span><span class="co">## A0:A1         0.0105    0.02138   0.492  6.23e-01</span></span></code></pre>
<p>Comparing with a naïve (unweighted) estimate.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survey/man/svyglm.html" class="external-link">svyglm</a></span><span class="op">(</span><span class="va">Y</span> <span class="op">~</span> <span class="va">A0</span><span class="op">*</span><span class="va">A1</span>, design <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/survey/man/svydesign.html" class="external-link">svydesign</a></span><span class="op">(</span><span class="op">~</span><span class="fl">1</span>,data<span class="op">=</span><span class="va">dat</span>,weights<span class="op">=</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">coef</span></span></code></pre></div>
<pre><code><span><span class="co">##             Estimate Std. Error t value  Pr(&gt;|t|)</span></span>
<span><span class="co">## (Intercept)  -0.5863    0.00897  -65.33  0.00e+00</span></span>
<span><span class="co">## A0            0.0484    0.01600    3.02  2.51e-03</span></span>
<span><span class="co">## A1            0.4671    0.01254   37.25 1.62e-299</span></span>
<span><span class="co">## A0:A1         0.1506    0.01959    7.68  1.57e-14</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Robin Evans, Xi Lin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer>
</div>






  </body>
</html>
